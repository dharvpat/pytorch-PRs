
======================================================================
MPS MEMORY LEAK TEST - Mode: FIXED
======================================================================
Testing fixes for Issues #2, #3, #4
Device: mps
Model: vae
Epochs: 10, Batches/epoch: 500
Total batches: 5000

Mode: FIXED - With cache clearing (simulates fixed PyTorch)
Expected: Stable memory after warmup due to:
  - Issue #2 fix: freeInactiveBuffers() called
  - Issue #3 fix: Event pool cleared
  - Issue #4 fix: Synchronization before cleanup
======================================================================

Initial memory state:
  Driver: 8.4MB (+8.4MB) | Current: 0.2MB | RSS: 362.6MB (+362.6MB)

======================================================================
WARMUP PHASE
======================================================================
Starting warmup phase...
Warmup complete (20 batches)

Baseline established after warmup:
  Driver: 10.8MB (+0.0MB) | Current: 0.3MB | RSS: 507.9MB (+0.0MB)

======================================================================
TRAINING PHASE
======================================================================
  Epoch 1/10, Batch 1/500 | Loss: 2.3277 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.5MB (-39.4MB)
  Epoch 1/10, Batch 21/500 | Loss: 2.4015 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 464.9MB (-43.0MB)
  Epoch 1/10, Batch 41/500 | Loss: 2.2575 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 466.5MB (-41.4MB)
  Epoch 1/10, Batch 61/500 | Loss: 2.3337 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.3MB (-39.6MB)
  Epoch 1/10, Batch 81/500 | Loss: 2.2932 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 467.9MB (-40.0MB)
  Epoch 1/10, Batch 101/500 | Loss: 2.3050 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 467.2MB (-40.7MB)
  Epoch 1/10, Batch 121/500 | Loss: 2.2826 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 467.5MB (-40.4MB)
  Epoch 1/10, Batch 141/500 | Loss: 2.3301 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 467.7MB (-40.2MB)
  Epoch 1/10, Batch 161/500 | Loss: 2.3240 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.0MB (-39.9MB)
  Epoch 1/10, Batch 181/500 | Loss: 2.3260 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.2MB (-39.8MB)
  Epoch 1/10, Batch 201/500 | Loss: 2.3356 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.2MB (-39.7MB)
  Epoch 1/10, Batch 221/500 | Loss: 2.3185 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 468.4MB (-39.5MB)
  Epoch 1/10, Batch 241/500 | Loss: 2.3028 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 467.9MB (-40.0MB)
  Epoch 1/10, Batch 261/500 | Loss: 2.3135 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.2MB (-53.7MB)
  Epoch 1/10, Batch 281/500 | Loss: 2.2948 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.8MB (-53.1MB)
  Epoch 1/10, Batch 301/500 | Loss: 2.3091 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.9MB (-53.0MB)
  Epoch 1/10, Batch 321/500 | Loss: 2.3274 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 455.2MB (-52.7MB)
  Epoch 1/10, Batch 341/500 | Loss: 2.2847 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 451.5MB (-56.4MB)
  Epoch 1/10, Batch 361/500 | Loss: 2.3123 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 451.7MB (-56.2MB)
  Epoch 1/10, Batch 381/500 | Loss: 2.3258 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 451.9MB (-56.0MB)
  Epoch 1/10, Batch 401/500 | Loss: 2.3177 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 452.5MB (-55.4MB)
  Epoch 1/10, Batch 421/500 | Loss: 2.3083 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 452.9MB (-55.0MB)
  Epoch 1/10, Batch 441/500 | Loss: 2.2860 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.2MB (-53.7MB)
  Epoch 1/10, Batch 461/500 | Loss: 2.3208 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.1MB (-53.8MB)
  Epoch 1/10, Batch 481/500 | Loss: 2.2742 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 454.2MB (-53.7MB)
  Epoch 1/10, Batch 500/500 | Loss: 2.2934 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 454.3MB (-53.6MB)
  └─ End-of-epoch cache clear: 0.0212s
Epoch 1 complete in 4.84s
  Epoch 2/10, Batch 1/500 | Loss: 2.3135 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 408.8MB (-99.1MB)
  Epoch 2/10, Batch 21/500 | Loss: 2.2925 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 409.4MB (-98.5MB)
  Epoch 2/10, Batch 41/500 | Loss: 2.3093 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 409.6MB (-98.3MB)
  Epoch 2/10, Batch 61/500 | Loss: 2.3202 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 409.8MB (-98.1MB)
  Epoch 2/10, Batch 81/500 | Loss: 2.3129 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 409.9MB (-98.0MB)
  Epoch 2/10, Batch 101/500 | Loss: 2.3175 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 410.3MB (-97.6MB)
  Epoch 2/10, Batch 121/500 | Loss: 2.2762 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 410.9MB (-97.0MB)
  Epoch 2/10, Batch 141/500 | Loss: 2.3218 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 410.9MB (-97.0MB)
  Epoch 2/10, Batch 161/500 | Loss: 2.2831 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.4MB (-96.5MB)
  Epoch 2/10, Batch 181/500 | Loss: 2.2982 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.5MB (-96.5MB)
  Epoch 2/10, Batch 201/500 | Loss: 2.2974 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.5MB (-96.4MB)
  Epoch 2/10, Batch 221/500 | Loss: 2.3035 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.5MB (-96.4MB)
  Epoch 2/10, Batch 241/500 | Loss: 2.3121 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.5MB (-96.4MB)
  Epoch 2/10, Batch 261/500 | Loss: 2.2829 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.8MB (-96.1MB)
  Epoch 2/10, Batch 281/500 | Loss: 2.2915 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.9MB (-96.0MB)
  Epoch 2/10, Batch 301/500 | Loss: 2.2859 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 411.9MB (-96.0MB)
  Epoch 2/10, Batch 321/500 | Loss: 2.3184 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.0MB (-95.9MB)
  Epoch 2/10, Batch 341/500 | Loss: 2.3040 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.1MB (-95.8MB)
  Epoch 2/10, Batch 361/500 | Loss: 2.3029 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.2MB (-95.8MB)
  Epoch 2/10, Batch 381/500 | Loss: 2.3075 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.2MB (-95.8MB)
  Epoch 2/10, Batch 401/500 | Loss: 2.2967 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.2MB (-95.7MB)
  Epoch 2/10, Batch 421/500 | Loss: 2.3056 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.2MB (-95.7MB)
  Epoch 2/10, Batch 441/500 | Loss: 2.2931 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.2MB (-95.7MB)
  Epoch 2/10, Batch 461/500 | Loss: 2.3030 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.3MB (-95.6MB)
  Epoch 2/10, Batch 481/500 | Loss: 2.2994 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.4MB (-95.5MB)
  Epoch 2/10, Batch 500/500 | Loss: 2.2969 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 412.6MB (-95.3MB)
  └─ End-of-epoch cache clear: 0.0219s
Epoch 2 complete in 5.03s
  Epoch 3/10, Batch 1/500 | Loss: 2.2947 | Time: 0.004s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.5MB (-95.4MB)
  Epoch 3/10, Batch 21/500 | Loss: 2.2836 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.6MB (-95.3MB)
  Epoch 3/10, Batch 41/500 | Loss: 2.2919 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 412.7MB (-95.2MB)
  Epoch 3/10, Batch 61/500 | Loss: 2.3209 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.2MB (-94.7MB)
  Epoch 3/10, Batch 81/500 | Loss: 2.2987 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.3MB (-94.6MB)
  Epoch 3/10, Batch 101/500 | Loss: 2.2919 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.4MB (-94.5MB)
  Epoch 3/10, Batch 121/500 | Loss: 2.3119 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.9MB (-94.0MB)
  Epoch 3/10, Batch 141/500 | Loss: 2.3120 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.9MB (-94.0MB)
  Epoch 3/10, Batch 161/500 | Loss: 2.2860 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 413.9MB (-94.0MB)
  Epoch 3/10, Batch 181/500 | Loss: 2.3094 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.0MB (-94.0MB)
  Epoch 3/10, Batch 201/500 | Loss: 2.2978 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.0MB (-93.9MB)
  Epoch 3/10, Batch 221/500 | Loss: 2.2904 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.0MB (-93.9MB)
  Epoch 3/10, Batch 241/500 | Loss: 2.3215 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.0MB (-93.9MB)
  Epoch 3/10, Batch 261/500 | Loss: 2.3054 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.3MB (-93.6MB)
  Epoch 3/10, Batch 281/500 | Loss: 2.3076 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.4MB (-93.5MB)
  Epoch 3/10, Batch 301/500 | Loss: 2.3078 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.5MB (-93.4MB)
  Epoch 3/10, Batch 321/500 | Loss: 2.3155 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.6MB (-93.3MB)
  Epoch 3/10, Batch 341/500 | Loss: 2.3110 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.6MB (-93.3MB)
  Epoch 3/10, Batch 361/500 | Loss: 2.2996 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.6MB (-93.3MB)
  Epoch 3/10, Batch 381/500 | Loss: 2.3013 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.7MB (-93.2MB)
  Epoch 3/10, Batch 401/500 | Loss: 2.3043 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.7MB (-93.2MB)
  Epoch 3/10, Batch 421/500 | Loss: 2.2980 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.7MB (-93.2MB)
  Epoch 3/10, Batch 441/500 | Loss: 2.3009 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.8MB (-93.1MB)
  Epoch 3/10, Batch 461/500 | Loss: 2.3035 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.8MB (-93.1MB)
  Epoch 3/10, Batch 481/500 | Loss: 2.3056 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.8MB (-93.1MB)
  Epoch 3/10, Batch 500/500 | Loss: 2.2991 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 414.9MB (-93.0MB)
  └─ End-of-epoch cache clear: 0.0218s
Epoch 3 complete in 4.93s
  Epoch 4/10, Batch 1/500 | Loss: 2.3165 | Time: 0.004s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 414.9MB (-93.0MB)
  Epoch 4/10, Batch 21/500 | Loss: 2.3021 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.1MB (-92.8MB)
  Epoch 4/10, Batch 41/500 | Loss: 2.3033 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.1MB (-92.8MB)
  Epoch 4/10, Batch 61/500 | Loss: 2.2871 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.1MB (-92.8MB)
  Epoch 4/10, Batch 81/500 | Loss: 2.2910 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.1MB (-92.8MB)
  Epoch 4/10, Batch 101/500 | Loss: 2.2993 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.1MB (-92.8MB)
  Epoch 4/10, Batch 121/500 | Loss: 2.3067 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.2MB (-92.7MB)
  Epoch 4/10, Batch 141/500 | Loss: 2.3005 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.2MB (-92.7MB)
  Epoch 4/10, Batch 161/500 | Loss: 2.3153 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.3MB (-92.6MB)
  Epoch 4/10, Batch 181/500 | Loss: 2.3042 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.3MB (-92.6MB)
  Epoch 4/10, Batch 201/500 | Loss: 2.2831 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.3MB (-92.6MB)
  Epoch 4/10, Batch 221/500 | Loss: 2.2941 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.3MB (-92.6MB)
  Epoch 4/10, Batch 241/500 | Loss: 2.3030 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.4MB (-92.5MB)
  Epoch 4/10, Batch 261/500 | Loss: 2.2979 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.4MB (-92.5MB)
  Epoch 4/10, Batch 281/500 | Loss: 2.3071 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.4MB (-92.5MB)
  Epoch 4/10, Batch 301/500 | Loss: 2.3006 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.4MB (-92.5MB)
  Epoch 4/10, Batch 321/500 | Loss: 2.3036 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.6MB (-92.3MB)
  Epoch 4/10, Batch 341/500 | Loss: 2.3021 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.6MB (-92.3MB)
  Epoch 4/10, Batch 361/500 | Loss: 2.3051 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.7MB (-92.2MB)
  Epoch 4/10, Batch 381/500 | Loss: 2.3051 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.7MB (-92.2MB)
  Epoch 4/10, Batch 401/500 | Loss: 2.3030 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.7MB (-92.2MB)
  Epoch 4/10, Batch 421/500 | Loss: 2.3073 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.8MB (-92.1MB)
  Epoch 4/10, Batch 441/500 | Loss: 2.3080 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.8MB (-92.1MB)
  Epoch 4/10, Batch 461/500 | Loss: 2.3122 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.8MB (-92.1MB)
  Epoch 4/10, Batch 481/500 | Loss: 2.3069 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.9MB (-92.0MB)
  Epoch 4/10, Batch 500/500 | Loss: 2.3093 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 416.0MB (-91.9MB)
  └─ End-of-epoch cache clear: 0.0228s
Epoch 4 complete in 4.85s
  Epoch 5/10, Batch 1/500 | Loss: 2.3059 | Time: 0.004s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 415.9MB (-92.0MB)
  Epoch 5/10, Batch 21/500 | Loss: 2.3058 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.0MB (-91.9MB)
  Epoch 5/10, Batch 41/500 | Loss: 2.2988 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.0MB (-91.9MB)
  Epoch 5/10, Batch 61/500 | Loss: 2.3001 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.1MB (-91.8MB)
  Epoch 5/10, Batch 81/500 | Loss: 2.3040 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.2MB (-91.8MB)
  Epoch 5/10, Batch 101/500 | Loss: 2.3038 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.3MB (-91.6MB)
  Epoch 5/10, Batch 121/500 | Loss: 2.3084 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.3MB (-91.6MB)
  Epoch 5/10, Batch 141/500 | Loss: 2.2952 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.3MB (-91.6MB)
  Epoch 5/10, Batch 161/500 | Loss: 2.2983 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.3MB (-91.6MB)
  Epoch 5/10, Batch 181/500 | Loss: 2.3057 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.4MB (-91.5MB)
  Epoch 5/10, Batch 201/500 | Loss: 2.3087 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.5MB (-91.5MB)
  Epoch 5/10, Batch 221/500 | Loss: 2.2949 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.5MB (-91.4MB)
  Epoch 5/10, Batch 241/500 | Loss: 2.3123 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.5MB (-91.4MB)
  Epoch 5/10, Batch 261/500 | Loss: 2.2991 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.6MB (-91.3MB)
  Epoch 5/10, Batch 281/500 | Loss: 2.3082 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.6MB (-91.3MB)
  Epoch 5/10, Batch 301/500 | Loss: 2.2854 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.7MB (-91.2MB)
  Epoch 5/10, Batch 321/500 | Loss: 2.3124 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.7MB (-91.2MB)
  Epoch 5/10, Batch 341/500 | Loss: 2.3044 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.7MB (-91.2MB)
  Epoch 5/10, Batch 361/500 | Loss: 2.3070 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.8MB (-91.1MB)
  Epoch 5/10, Batch 381/500 | Loss: 2.3145 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.8MB (-91.1MB)
  Epoch 5/10, Batch 401/500 | Loss: 2.3103 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.8MB (-91.1MB)
  Epoch 5/10, Batch 421/500 | Loss: 2.3085 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.8MB (-91.1MB)
  Epoch 5/10, Batch 441/500 | Loss: 2.3023 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.9MB (-91.0MB)
  Epoch 5/10, Batch 461/500 | Loss: 2.3064 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.0MB (-91.0MB)
  Epoch 5/10, Batch 481/500 | Loss: 2.3066 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.0MB (-90.9MB)
  Epoch 5/10, Batch 500/500 | Loss: 2.3051 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 417.0MB (-90.9MB)
  └─ End-of-epoch cache clear: 0.0218s
Epoch 5 complete in 4.85s
  Epoch 6/10, Batch 1/500 | Loss: 2.3092 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 416.9MB (-91.0MB)
  Epoch 6/10, Batch 21/500 | Loss: 2.2876 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.0MB (-90.9MB)
  Epoch 6/10, Batch 41/500 | Loss: 2.2976 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.1MB (-90.8MB)
  Epoch 6/10, Batch 61/500 | Loss: 2.3163 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.1MB (-90.8MB)
  Epoch 6/10, Batch 81/500 | Loss: 2.3101 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.1MB (-90.8MB)
  Epoch 6/10, Batch 101/500 | Loss: 2.2986 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.2MB (-90.7MB)
  Epoch 6/10, Batch 121/500 | Loss: 2.3006 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.3MB (-90.6MB)
  Epoch 6/10, Batch 141/500 | Loss: 2.3203 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.3MB (-90.6MB)
  Epoch 6/10, Batch 161/500 | Loss: 2.3009 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.3MB (-90.6MB)
  Epoch 6/10, Batch 181/500 | Loss: 2.3081 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.4MB (-90.5MB)
  Epoch 6/10, Batch 201/500 | Loss: 2.3143 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.4MB (-90.5MB)
  Epoch 6/10, Batch 221/500 | Loss: 2.3097 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.5MB (-90.4MB)
  Epoch 6/10, Batch 241/500 | Loss: 2.3024 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.5MB (-90.4MB)
  Epoch 6/10, Batch 261/500 | Loss: 2.3026 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.5MB (-90.4MB)
  Epoch 6/10, Batch 281/500 | Loss: 2.2911 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.5MB (-90.4MB)
  Epoch 6/10, Batch 301/500 | Loss: 2.2886 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.5MB (-90.4MB)
  Epoch 6/10, Batch 321/500 | Loss: 2.3077 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.6MB (-90.3MB)
  Epoch 6/10, Batch 341/500 | Loss: 2.2934 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.6MB (-90.3MB)
  Epoch 6/10, Batch 361/500 | Loss: 2.2997 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.7MB (-90.2MB)
  Epoch 6/10, Batch 381/500 | Loss: 2.3125 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.7MB (-90.2MB)
  Epoch 6/10, Batch 401/500 | Loss: 2.3134 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 6/10, Batch 421/500 | Loss: 2.3004 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 6/10, Batch 441/500 | Loss: 2.3013 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.9MB (-90.0MB)
  Epoch 6/10, Batch 461/500 | Loss: 2.2964 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.9MB (-90.0MB)
  Epoch 6/10, Batch 481/500 | Loss: 2.3120 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.0MB (-89.9MB)
  Epoch 6/10, Batch 500/500 | Loss: 2.2902 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 418.0MB (-89.9MB)
  └─ End-of-epoch cache clear: 0.0168s
Epoch 6 complete in 4.85s
  Epoch 7/10, Batch 1/500 | Loss: 2.3071 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.6MB (-90.3MB)
  Epoch 7/10, Batch 21/500 | Loss: 2.3059 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 7/10, Batch 41/500 | Loss: 2.3041 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 7/10, Batch 61/500 | Loss: 2.3045 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 7/10, Batch 81/500 | Loss: 2.3110 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.8MB (-90.1MB)
  Epoch 7/10, Batch 101/500 | Loss: 2.3032 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 417.9MB (-90.0MB)
  Epoch 7/10, Batch 121/500 | Loss: 2.2999 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.0MB (-89.9MB)
  Epoch 7/10, Batch 141/500 | Loss: 2.3121 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.0MB (-89.9MB)
  Epoch 7/10, Batch 161/500 | Loss: 2.2950 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.2MB (-89.7MB)
  Epoch 7/10, Batch 181/500 | Loss: 2.3027 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 7/10, Batch 201/500 | Loss: 2.2980 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 7/10, Batch 221/500 | Loss: 2.2998 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 7/10, Batch 241/500 | Loss: 2.3065 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.4MB (-89.5MB)
  Epoch 7/10, Batch 261/500 | Loss: 2.2944 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.4MB (-89.5MB)
  Epoch 7/10, Batch 281/500 | Loss: 2.2991 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.6MB (-89.3MB)
  Epoch 7/10, Batch 301/500 | Loss: 2.3031 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 7/10, Batch 321/500 | Loss: 2.2953 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 7/10, Batch 341/500 | Loss: 2.2930 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 7/10, Batch 361/500 | Loss: 2.3090 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.8MB (-89.2MB)
  Epoch 7/10, Batch 381/500 | Loss: 2.2889 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.8MB (-89.1MB)
  Epoch 7/10, Batch 401/500 | Loss: 2.3063 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.8MB (-89.1MB)
  Epoch 7/10, Batch 421/500 | Loss: 2.2814 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 7/10, Batch 441/500 | Loss: 2.3194 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 7/10, Batch 461/500 | Loss: 2.3080 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 7/10, Batch 481/500 | Loss: 2.3120 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.0MB (-88.9MB)
  Epoch 7/10, Batch 500/500 | Loss: 2.2944 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 419.1MB (-88.8MB)
  └─ End-of-epoch cache clear: 0.0220s
Epoch 7 complete in 4.84s
  Epoch 8/10, Batch 1/500 | Loss: 2.2970 | Time: 0.004s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.0MB (-88.9MB)
  Epoch 8/10, Batch 21/500 | Loss: 2.3012 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.1MB (-88.8MB)
  Epoch 8/10, Batch 41/500 | Loss: 2.3000 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.1MB (-88.8MB)
  Epoch 8/10, Batch 61/500 | Loss: 2.2994 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.8MB)
  Epoch 8/10, Batch 81/500 | Loss: 2.2993 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 8/10, Batch 101/500 | Loss: 2.2995 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 8/10, Batch 121/500 | Loss: 2.2971 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 8/10, Batch 141/500 | Loss: 2.3019 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 8/10, Batch 161/500 | Loss: 2.3048 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.3MB (-88.6MB)
  Epoch 8/10, Batch 181/500 | Loss: 2.2962 | Time: 0.005s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 8/10, Batch 201/500 | Loss: 2.3030 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.6MB (-88.3MB)
  Epoch 8/10, Batch 221/500 | Loss: 2.2986 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.6MB (-88.3MB)
  Epoch 8/10, Batch 241/500 | Loss: 2.3117 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.7MB (-88.2MB)
  Epoch 8/10, Batch 261/500 | Loss: 2.3011 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.9MB (-88.0MB)
  Epoch 8/10, Batch 281/500 | Loss: 2.2977 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.9MB (-88.0MB)
  Epoch 8/10, Batch 301/500 | Loss: 2.3165 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.9MB (-88.0MB)
  Epoch 8/10, Batch 321/500 | Loss: 2.2964 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.0MB (-88.0MB)
  Epoch 8/10, Batch 341/500 | Loss: 2.3022 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.0MB (-87.9MB)
  Epoch 8/10, Batch 361/500 | Loss: 2.3190 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.1MB (-87.8MB)
  Epoch 8/10, Batch 381/500 | Loss: 2.3036 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.1MB (-87.8MB)
  Epoch 8/10, Batch 401/500 | Loss: 2.2878 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 8/10, Batch 421/500 | Loss: 2.3158 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 8/10, Batch 441/500 | Loss: 2.2993 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 8/10, Batch 461/500 | Loss: 2.3110 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 8/10, Batch 481/500 | Loss: 2.3063 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 8/10, Batch 500/500 | Loss: 2.3005 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 420.3MB (-87.6MB)
  └─ End-of-epoch cache clear: 0.0222s
Epoch 8 complete in 4.86s
  Epoch 9/10, Batch 1/500 | Loss: 2.2996 | Time: 0.004s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.1MB (-89.8MB)
  Epoch 9/10, Batch 21/500 | Loss: 2.3058 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 9/10, Batch 41/500 | Loss: 2.3027 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 9/10, Batch 61/500 | Loss: 2.3035 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 9/10, Batch 81/500 | Loss: 2.2990 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.3MB (-89.6MB)
  Epoch 9/10, Batch 101/500 | Loss: 2.3030 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.4MB (-89.5MB)
  Epoch 9/10, Batch 121/500 | Loss: 2.3025 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.4MB (-89.5MB)
  Epoch 9/10, Batch 141/500 | Loss: 2.3015 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.5MB (-89.4MB)
  Epoch 9/10, Batch 161/500 | Loss: 2.3033 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.6MB (-89.3MB)
  Epoch 9/10, Batch 181/500 | Loss: 2.3024 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 9/10, Batch 201/500 | Loss: 2.3005 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 9/10, Batch 221/500 | Loss: 2.2957 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 9/10, Batch 241/500 | Loss: 2.3103 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 9/10, Batch 261/500 | Loss: 2.2987 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.7MB (-89.2MB)
  Epoch 9/10, Batch 281/500 | Loss: 2.2984 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.8MB (-89.2MB)
  Epoch 9/10, Batch 301/500 | Loss: 2.3014 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.8MB (-89.1MB)
  Epoch 9/10, Batch 321/500 | Loss: 2.3037 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 9/10, Batch 341/500 | Loss: 2.3029 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 9/10, Batch 361/500 | Loss: 2.2983 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 418.9MB (-89.0MB)
  Epoch 9/10, Batch 381/500 | Loss: 2.3045 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.0MB (-88.9MB)
  Epoch 9/10, Batch 401/500 | Loss: 2.2924 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.0MB (-88.9MB)
  Epoch 9/10, Batch 421/500 | Loss: 2.3023 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.0MB (-88.9MB)
  Epoch 9/10, Batch 441/500 | Loss: 2.3067 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.1MB (-88.8MB)
  Epoch 9/10, Batch 461/500 | Loss: 2.3107 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 9/10, Batch 481/500 | Loss: 2.3058 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.3MB (-88.6MB)
  Epoch 9/10, Batch 500/500 | Loss: 2.3066 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 419.3MB (-88.6MB)
  └─ End-of-epoch cache clear: 0.0192s
Epoch 9 complete in 4.86s
  Epoch 10/10, Batch 1/500 | Loss: 2.3024 | Time: 0.003s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.2MB (-88.7MB)
  Epoch 10/10, Batch 21/500 | Loss: 2.3043 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.4MB (-88.5MB)
  Epoch 10/10, Batch 41/500 | Loss: 2.3018 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.4MB (-88.5MB)
  Epoch 10/10, Batch 61/500 | Loss: 2.3005 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.4MB (-88.5MB)
  Epoch 10/10, Batch 81/500 | Loss: 2.3007 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.4MB (-88.5MB)
  Epoch 10/10, Batch 101/500 | Loss: 2.3035 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 10/10, Batch 121/500 | Loss: 2.2965 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 10/10, Batch 141/500 | Loss: 2.3112 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 10/10, Batch 161/500 | Loss: 2.3073 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 10/10, Batch 181/500 | Loss: 2.3032 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.5MB (-88.4MB)
  Epoch 10/10, Batch 201/500 | Loss: 2.3109 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.6MB (-88.3MB)
  Epoch 10/10, Batch 221/500 | Loss: 2.3033 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.6MB (-88.3MB)
  Epoch 10/10, Batch 241/500 | Loss: 2.3070 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.7MB (-88.2MB)
  Epoch 10/10, Batch 261/500 | Loss: 2.3042 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 419.8MB (-88.1MB)
  Epoch 10/10, Batch 281/500 | Loss: 2.3199 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.1MB (-87.8MB)
  Epoch 10/10, Batch 301/500 | Loss: 2.3064 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.1MB (-87.8MB)
  Epoch 10/10, Batch 321/500 | Loss: 2.3025 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.1MB (-87.8MB)
  Epoch 10/10, Batch 341/500 | Loss: 2.2990 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 10/10, Batch 361/500 | Loss: 2.3034 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 10/10, Batch 381/500 | Loss: 2.2982 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 10/10, Batch 401/500 | Loss: 2.3000 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.2MB (-87.7MB)
  Epoch 10/10, Batch 421/500 | Loss: 2.3162 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.3MB (-87.6MB)
  Epoch 10/10, Batch 441/500 | Loss: 2.2972 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.3MB (-87.6MB)
  Epoch 10/10, Batch 461/500 | Loss: 2.3004 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.3MB (-87.6MB)
  Epoch 10/10, Batch 481/500 | Loss: 2.3057 | Time: 0.010s | Driver: 1082.8MB (+1072.0MB) | Current: 2.1MB | RSS: 420.4MB (-87.5MB)
  Epoch 10/10, Batch 500/500 | Loss: 2.2882 | Time: 0.009s | Driver: 1082.8MB (+1072.0MB) | Current: 8.6MB | RSS: 420.4MB (-87.5MB)
  └─ End-of-epoch cache clear: 0.0217s
Epoch 10 complete in 4.87s

======================================================================
FINAL CLEANUP
======================================================================
Synchronizing GPU...
Clearing cache...

Final memory state:
  Driver: 10.8MB (+0.0MB) | Current: 0.3MB | RSS: 422.5MB (-85.4MB)

======================================================================
SUMMARY
======================================================================

Memory Growth:
  Driver Memory: 1082.8MB → 1082.8MB (+0.0MB)
  RSS (Activity Monitor): 508.0MB → 420.4MB (+-87.6MB)

Growth Rates:
  Driver: 0.000MB/batch
  RSS: -0.018MB/batch

Cache Clearing:
  Total clears: 10
  Total time: 0.21s
  Average time: 0.0211s

Diagnosis:
  ✅ PASS: Memory stable (fixes working!)
     Issues #2, #3, #4 are properly fixed
======================================================================

✅ Results saved to: test_results_20251027_110740/fixed_vae_20251027_110740.json

