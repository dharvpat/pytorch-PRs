
======================================================================
MPS MEMORY LEAK TEST - Mode: FIXED
======================================================================
Testing fixes for Issues #2, #3, #4
Device: mps
Model: lstm
Epochs: 10, Batches/epoch: 500
Total batches: 5000

Mode: FIXED - With cache clearing (simulates fixed PyTorch)
Expected: Stable memory after warmup due to:
  - Issue #2 fix: freeInactiveBuffers() called
  - Issue #3 fix: Event pool cleared
  - Issue #4 fix: Synchronization before cleanup
======================================================================

Initial memory state:
  Driver: 8.4MB (+8.4MB) | Current: 0.2MB | RSS: 375.5MB (+375.5MB)

======================================================================
WARMUP PHASE
======================================================================
Starting warmup phase...
Warmup complete (20 batches)

Baseline established after warmup:
  Driver: 68.8MB (+0.0MB) | Current: 0.6MB | RSS: 401.2MB (+0.0MB)

======================================================================
TRAINING PHASE
======================================================================
  Epoch 1/10, Batch 1/500 | Loss: 2.3185 | Time: 0.005s | Driver: 28.8MB (-40.0MB) | Current: 2.5MB | RSS: 401.3MB (+0.0MB)
  Epoch 1/10, Batch 21/500 | Loss: 2.3095 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 401.7MB (+0.5MB)
  Epoch 1/10, Batch 41/500 | Loss: 2.3229 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 401.8MB (+0.6MB)
  Epoch 1/10, Batch 61/500 | Loss: 2.3252 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 402.0MB (+0.7MB)
  Epoch 1/10, Batch 81/500 | Loss: 2.2994 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 402.0MB (+0.8MB)
  Epoch 1/10, Batch 101/500 | Loss: 2.3061 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 402.0MB (+0.8MB)
  Epoch 1/10, Batch 121/500 | Loss: 2.2977 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 402.1MB (+0.8MB)
  Epoch 1/10, Batch 141/500 | Loss: 2.3009 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 402.1MB (+0.9MB)
  Epoch 1/10, Batch 161/500 | Loss: 2.3191 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.1MB (-1.1MB)
  Epoch 1/10, Batch 181/500 | Loss: 2.3073 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 201/500 | Loss: 2.3016 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 221/500 | Loss: 2.3002 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 241/500 | Loss: 2.3102 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 261/500 | Loss: 2.3120 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 281/500 | Loss: 2.3007 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.2MB (-1.0MB)
  Epoch 1/10, Batch 301/500 | Loss: 2.2711 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.3MB (-0.9MB)
  Epoch 1/10, Batch 321/500 | Loss: 2.3092 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.3MB (-0.9MB)
  Epoch 1/10, Batch 341/500 | Loss: 2.3165 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.3MB (-0.9MB)
  Epoch 1/10, Batch 361/500 | Loss: 2.3018 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.3MB (-0.9MB)
  Epoch 1/10, Batch 381/500 | Loss: 2.3042 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.9MB)
  Epoch 1/10, Batch 401/500 | Loss: 2.3135 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.9MB)
  Epoch 1/10, Batch 421/500 | Loss: 2.3133 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.8MB)
  Epoch 1/10, Batch 441/500 | Loss: 2.3060 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.8MB)
  Epoch 1/10, Batch 461/500 | Loss: 2.3077 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.8MB)
  Epoch 1/10, Batch 481/500 | Loss: 2.2960 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.4MB (-0.8MB)
  Epoch 1/10, Batch 500/500 | Loss: 2.3035 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.5MB (-0.8MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 1 complete in 1.22s
  Epoch 2/10, Batch 1/500 | Loss: 2.3161 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.8MB)
  Epoch 2/10, Batch 21/500 | Loss: 2.3107 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.8MB)
  Epoch 2/10, Batch 41/500 | Loss: 2.3146 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 61/500 | Loss: 2.2985 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 81/500 | Loss: 2.3090 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 101/500 | Loss: 2.3075 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 121/500 | Loss: 2.3127 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 141/500 | Loss: 2.2997 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.5MB (-0.7MB)
  Epoch 2/10, Batch 161/500 | Loss: 2.2981 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 181/500 | Loss: 2.3084 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 201/500 | Loss: 2.3186 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 221/500 | Loss: 2.2938 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 241/500 | Loss: 2.3028 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 261/500 | Loss: 2.2880 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.6MB (-0.6MB)
  Epoch 2/10, Batch 281/500 | Loss: 2.3091 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 301/500 | Loss: 2.3176 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 321/500 | Loss: 2.3002 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 341/500 | Loss: 2.2970 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 361/500 | Loss: 2.3090 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 381/500 | Loss: 2.2921 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.7MB (-0.5MB)
  Epoch 2/10, Batch 401/500 | Loss: 2.3071 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.8MB (-0.5MB)
  Epoch 2/10, Batch 421/500 | Loss: 2.2969 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.8MB (-0.4MB)
  Epoch 2/10, Batch 441/500 | Loss: 2.3095 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.8MB (-0.4MB)
  Epoch 2/10, Batch 461/500 | Loss: 2.3022 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.8MB (-0.4MB)
  Epoch 2/10, Batch 481/500 | Loss: 2.3140 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.5MB | RSS: 400.9MB (-0.4MB)
  Epoch 2/10, Batch 500/500 | Loss: 2.3096 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.4MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 2 complete in 1.19s
  Epoch 3/10, Batch 1/500 | Loss: 2.2995 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.4MB)
  Epoch 3/10, Batch 21/500 | Loss: 2.2977 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 41/500 | Loss: 2.2988 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 61/500 | Loss: 2.3068 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 81/500 | Loss: 2.3044 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 101/500 | Loss: 2.3144 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 121/500 | Loss: 2.3115 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 141/500 | Loss: 2.3003 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.5MB)
  Epoch 3/10, Batch 161/500 | Loss: 2.2959 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.5MB)
  Epoch 3/10, Batch 181/500 | Loss: 2.3009 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 201/500 | Loss: 2.3116 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 221/500 | Loss: 2.2848 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 241/500 | Loss: 2.2980 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 261/500 | Loss: 2.3103 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.8MB (-0.4MB)
  Epoch 3/10, Batch 281/500 | Loss: 2.2999 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 301/500 | Loss: 2.2909 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 321/500 | Loss: 2.2931 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 341/500 | Loss: 2.3021 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 361/500 | Loss: 2.3062 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 400.9MB (-0.3MB)
  Epoch 3/10, Batch 381/500 | Loss: 2.3036 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 401.0MB (-0.2MB)
  Epoch 3/10, Batch 401/500 | Loss: 2.3112 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 401.0MB (-0.2MB)
  Epoch 3/10, Batch 421/500 | Loss: 2.2893 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 401.0MB (-0.2MB)
  Epoch 3/10, Batch 441/500 | Loss: 2.3057 | Time: 0.013s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 401.1MB (-0.1MB)
  Epoch 3/10, Batch 461/500 | Loss: 2.3073 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  Epoch 3/10, Batch 481/500 | Loss: 2.3075 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.5MB (-6.7MB)
  Epoch 3/10, Batch 500/500 | Loss: 2.3070 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.5MB (-6.7MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 3 complete in 1.39s
  Epoch 4/10, Batch 1/500 | Loss: 2.2962 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.5MB (-6.7MB)
  Epoch 4/10, Batch 21/500 | Loss: 2.2820 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.5MB (-6.7MB)
  Epoch 4/10, Batch 41/500 | Loss: 2.3021 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 61/500 | Loss: 2.3079 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 81/500 | Loss: 2.3149 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 101/500 | Loss: 2.3142 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 121/500 | Loss: 2.3024 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 141/500 | Loss: 2.3044 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.6MB (-6.6MB)
  Epoch 4/10, Batch 161/500 | Loss: 2.3071 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.6MB)
  Epoch 4/10, Batch 181/500 | Loss: 2.3160 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.5MB)
  Epoch 4/10, Batch 201/500 | Loss: 2.3114 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.5MB)
  Epoch 4/10, Batch 221/500 | Loss: 2.3007 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.5MB)
  Epoch 4/10, Batch 241/500 | Loss: 2.2926 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.5MB)
  Epoch 4/10, Batch 261/500 | Loss: 2.3030 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.7MB (-6.5MB)
  Epoch 4/10, Batch 281/500 | Loss: 2.3059 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.5MB)
  Epoch 4/10, Batch 301/500 | Loss: 2.3048 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.5MB)
  Epoch 4/10, Batch 321/500 | Loss: 2.3143 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 341/500 | Loss: 2.3085 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 361/500 | Loss: 2.2954 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 381/500 | Loss: 2.2972 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 401/500 | Loss: 2.3039 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 421/500 | Loss: 2.2960 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.8MB (-6.4MB)
  Epoch 4/10, Batch 441/500 | Loss: 2.2992 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 4/10, Batch 461/500 | Loss: 2.2987 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 4/10, Batch 481/500 | Loss: 2.3011 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 4/10, Batch 500/500 | Loss: 2.3095 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 4 complete in 1.17s
  Epoch 5/10, Batch 1/500 | Loss: 2.3016 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 5/10, Batch 21/500 | Loss: 2.3142 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 5/10, Batch 41/500 | Loss: 2.3086 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 394.9MB (-6.3MB)
  Epoch 5/10, Batch 61/500 | Loss: 2.2961 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 81/500 | Loss: 2.3135 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 101/500 | Loss: 2.2924 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 121/500 | Loss: 2.2997 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 141/500 | Loss: 2.3113 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 161/500 | Loss: 2.2909 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.0MB (-6.2MB)
  Epoch 5/10, Batch 181/500 | Loss: 2.3116 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.2MB)
  Epoch 5/10, Batch 201/500 | Loss: 2.3232 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.2MB)
  Epoch 5/10, Batch 221/500 | Loss: 2.2957 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 241/500 | Loss: 2.3116 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 261/500 | Loss: 2.3094 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 281/500 | Loss: 2.3036 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 301/500 | Loss: 2.3139 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 321/500 | Loss: 2.3082 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.1MB (-6.1MB)
  Epoch 5/10, Batch 341/500 | Loss: 2.3102 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 361/500 | Loss: 2.3035 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 381/500 | Loss: 2.2990 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 401/500 | Loss: 2.2963 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 421/500 | Loss: 2.2982 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 441/500 | Loss: 2.3147 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.2MB (-6.0MB)
  Epoch 5/10, Batch 461/500 | Loss: 2.3050 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-6.0MB)
  Epoch 5/10, Batch 481/500 | Loss: 2.3047 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-6.0MB)
  Epoch 5/10, Batch 500/500 | Loss: 2.3038 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 5 complete in 1.18s
  Epoch 6/10, Batch 1/500 | Loss: 2.2915 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 21/500 | Loss: 2.3043 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 41/500 | Loss: 2.2985 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 61/500 | Loss: 2.3091 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 81/500 | Loss: 2.3082 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 101/500 | Loss: 2.2964 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.3MB (-5.9MB)
  Epoch 6/10, Batch 121/500 | Loss: 2.3029 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.9MB)
  Epoch 6/10, Batch 141/500 | Loss: 2.2922 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.8MB)
  Epoch 6/10, Batch 161/500 | Loss: 2.3108 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.8MB)
  Epoch 6/10, Batch 181/500 | Loss: 2.3011 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.8MB)
  Epoch 6/10, Batch 201/500 | Loss: 2.3071 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.8MB)
  Epoch 6/10, Batch 221/500 | Loss: 2.3063 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.4MB (-5.8MB)
  Epoch 6/10, Batch 241/500 | Loss: 2.3022 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.8MB)
  Epoch 6/10, Batch 261/500 | Loss: 2.2971 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.8MB)
  Epoch 6/10, Batch 281/500 | Loss: 2.3016 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 301/500 | Loss: 2.3025 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 321/500 | Loss: 2.2935 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 341/500 | Loss: 2.3036 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 361/500 | Loss: 2.2963 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 381/500 | Loss: 2.3049 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.5MB (-5.7MB)
  Epoch 6/10, Batch 401/500 | Loss: 2.3043 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.7MB)
  Epoch 6/10, Batch 421/500 | Loss: 2.2976 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.7MB)
  Epoch 6/10, Batch 441/500 | Loss: 2.3104 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  Epoch 6/10, Batch 461/500 | Loss: 2.3127 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  Epoch 6/10, Batch 481/500 | Loss: 2.3086 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  Epoch 6/10, Batch 500/500 | Loss: 2.2936 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 6 complete in 1.20s
  Epoch 7/10, Batch 1/500 | Loss: 2.3082 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.6MB (-5.6MB)
  Epoch 7/10, Batch 21/500 | Loss: 2.3061 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 41/500 | Loss: 2.2984 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 61/500 | Loss: 2.3050 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 81/500 | Loss: 2.3002 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 101/500 | Loss: 2.2960 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 121/500 | Loss: 2.3036 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.7MB (-5.5MB)
  Epoch 7/10, Batch 141/500 | Loss: 2.3004 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.5MB)
  Epoch 7/10, Batch 161/500 | Loss: 2.2992 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.5MB)
  Epoch 7/10, Batch 181/500 | Loss: 2.3002 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.4MB)
  Epoch 7/10, Batch 201/500 | Loss: 2.3012 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.4MB)
  Epoch 7/10, Batch 221/500 | Loss: 2.3028 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.4MB)
  Epoch 7/10, Batch 241/500 | Loss: 2.3075 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.4MB)
  Epoch 7/10, Batch 261/500 | Loss: 2.3052 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.8MB (-5.4MB)
  Epoch 7/10, Batch 281/500 | Loss: 2.3031 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.4MB)
  Epoch 7/10, Batch 301/500 | Loss: 2.3140 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 321/500 | Loss: 2.3020 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 341/500 | Loss: 2.3164 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 361/500 | Loss: 2.3124 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 381/500 | Loss: 2.3045 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 401/500 | Loss: 2.2997 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 395.9MB (-5.3MB)
  Epoch 7/10, Batch 421/500 | Loss: 2.3111 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  Epoch 7/10, Batch 441/500 | Loss: 2.3041 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  Epoch 7/10, Batch 461/500 | Loss: 2.3073 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  Epoch 7/10, Batch 481/500 | Loss: 2.3013 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  Epoch 7/10, Batch 500/500 | Loss: 2.3048 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 7 complete in 1.21s
  Epoch 8/10, Batch 1/500 | Loss: 2.3041 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.0MB (-5.2MB)
  Epoch 8/10, Batch 21/500 | Loss: 2.3020 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.2MB)
  Epoch 8/10, Batch 41/500 | Loss: 2.2945 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 61/500 | Loss: 2.3010 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 81/500 | Loss: 2.2895 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 101/500 | Loss: 2.3087 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 121/500 | Loss: 2.3013 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 141/500 | Loss: 2.2993 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.1MB (-5.1MB)
  Epoch 8/10, Batch 161/500 | Loss: 2.3043 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.2MB (-5.0MB)
  Epoch 8/10, Batch 181/500 | Loss: 2.3076 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.2MB (-5.0MB)
  Epoch 8/10, Batch 201/500 | Loss: 2.3013 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.2MB (-5.0MB)
  Epoch 8/10, Batch 221/500 | Loss: 2.2969 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.2MB (-5.0MB)
  Epoch 8/10, Batch 241/500 | Loss: 2.3054 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-5.0MB)
  Epoch 8/10, Batch 261/500 | Loss: 2.3044 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-5.0MB)
  Epoch 8/10, Batch 281/500 | Loss: 2.2923 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 301/500 | Loss: 2.2967 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 321/500 | Loss: 2.2961 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 341/500 | Loss: 2.3063 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 361/500 | Loss: 2.2999 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 381/500 | Loss: 2.3110 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.3MB (-4.9MB)
  Epoch 8/10, Batch 401/500 | Loss: 2.3077 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 8/10, Batch 421/500 | Loss: 2.3158 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 8/10, Batch 441/500 | Loss: 2.3061 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 8/10, Batch 461/500 | Loss: 2.3047 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 8/10, Batch 481/500 | Loss: 2.3018 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 8/10, Batch 500/500 | Loss: 2.3027 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 8 complete in 1.22s
  Epoch 9/10, Batch 1/500 | Loss: 2.3053 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.4MB (-4.8MB)
  Epoch 9/10, Batch 21/500 | Loss: 2.3014 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.8MB)
  Epoch 9/10, Batch 41/500 | Loss: 2.3000 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.8MB)
  Epoch 9/10, Batch 61/500 | Loss: 2.2987 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.7MB)
  Epoch 9/10, Batch 81/500 | Loss: 2.3030 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.7MB)
  Epoch 9/10, Batch 101/500 | Loss: 2.3072 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.7MB)
  Epoch 9/10, Batch 121/500 | Loss: 2.3074 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.5MB (-4.7MB)
  Epoch 9/10, Batch 141/500 | Loss: 2.3004 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.7MB)
  Epoch 9/10, Batch 161/500 | Loss: 2.3001 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.7MB)
  Epoch 9/10, Batch 181/500 | Loss: 2.3035 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.6MB)
  Epoch 9/10, Batch 201/500 | Loss: 2.3004 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.6MB)
  Epoch 9/10, Batch 221/500 | Loss: 2.3047 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.6MB)
  Epoch 9/10, Batch 241/500 | Loss: 2.2997 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.6MB)
  Epoch 9/10, Batch 261/500 | Loss: 2.3136 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.6MB (-4.6MB)
  Epoch 9/10, Batch 281/500 | Loss: 2.2978 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.7MB (-4.6MB)
  Epoch 9/10, Batch 301/500 | Loss: 2.2986 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.7MB (-4.5MB)
  Epoch 9/10, Batch 321/500 | Loss: 2.3048 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.7MB (-4.5MB)
  Epoch 9/10, Batch 341/500 | Loss: 2.3061 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.7MB (-4.5MB)
  Epoch 9/10, Batch 361/500 | Loss: 2.3057 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.7MB (-4.5MB)
  Epoch 9/10, Batch 381/500 | Loss: 2.3038 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.5MB)
  Epoch 9/10, Batch 401/500 | Loss: 2.3032 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.5MB)
  Epoch 9/10, Batch 421/500 | Loss: 2.2928 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.5MB)
  Epoch 9/10, Batch 441/500 | Loss: 2.2949 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  Epoch 9/10, Batch 461/500 | Loss: 2.3068 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  Epoch 9/10, Batch 481/500 | Loss: 2.3140 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  Epoch 9/10, Batch 500/500 | Loss: 2.2942 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 9 complete in 1.22s
  Epoch 10/10, Batch 1/500 | Loss: 2.3163 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  Epoch 10/10, Batch 21/500 | Loss: 2.3014 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.8MB (-4.4MB)
  Epoch 10/10, Batch 41/500 | Loss: 2.2977 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.4MB)
  Epoch 10/10, Batch 61/500 | Loss: 2.2953 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 81/500 | Loss: 2.3064 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 101/500 | Loss: 2.3034 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 121/500 | Loss: 2.3047 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 141/500 | Loss: 2.3090 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 161/500 | Loss: 2.2935 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 396.9MB (-4.3MB)
  Epoch 10/10, Batch 181/500 | Loss: 2.3033 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.3MB)
  Epoch 10/10, Batch 201/500 | Loss: 2.3020 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 221/500 | Loss: 2.3089 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 241/500 | Loss: 2.3011 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 261/500 | Loss: 2.3008 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 281/500 | Loss: 2.3043 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 301/500 | Loss: 2.2999 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.0MB (-4.2MB)
  Epoch 10/10, Batch 321/500 | Loss: 2.3012 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.2MB)
  Epoch 10/10, Batch 341/500 | Loss: 2.2994 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.2MB)
  Epoch 10/10, Batch 361/500 | Loss: 2.3038 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 381/500 | Loss: 2.3027 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 401/500 | Loss: 2.3031 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 421/500 | Loss: 2.2995 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 441/500 | Loss: 2.3000 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 461/500 | Loss: 2.2968 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.1MB (-4.1MB)
  Epoch 10/10, Batch 481/500 | Loss: 2.3114 | Time: 0.003s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.2MB (-4.0MB)
  Epoch 10/10, Batch 500/500 | Loss: 2.3022 | Time: 0.002s | Driver: 84.8MB (+16.0MB) | Current: 2.6MB | RSS: 397.2MB (-4.0MB)
  └─ End-of-epoch cache clear: 0.0002s
Epoch 10 complete in 1.22s

======================================================================
FINAL CLEANUP
======================================================================
Synchronizing GPU...
Clearing cache...

Final memory state:
  Driver: 68.8MB (+0.0MB) | Current: 0.6MB | RSS: 397.2MB (-4.0MB)

======================================================================
SUMMARY
======================================================================

Memory Growth:
  Driver Memory: 28.8MB → 84.8MB (+56.0MB)
  RSS (Activity Monitor): 401.2MB → 397.2MB (+-4.1MB)

Growth Rates:
  Driver: 0.011MB/batch
  RSS: -0.001MB/batch

Cache Clearing:
  Total clears: 10
  Total time: 0.00s
  Average time: 0.0002s

Diagnosis:
  ✅ PASS: Memory stable (fixes working!)
     Issues #2, #3, #4 are properly fixed
======================================================================

✅ Results saved to: test_results_20251027_110740/fixed_lstm_20251027_110740.json

